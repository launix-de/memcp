# ORDER BY and LIMIT/OFFSET

metadata:
  version: "1.0"
  description: "Ordering by multiple keys with pagination"

setup:
  - sql: "DROP TABLE IF EXISTS ord_t"
  - sql: "CREATE TABLE ord_t (a INT, b INT)"
  - sql: |
      INSERT INTO ord_t (a,b) VALUES
      (1,2),(1,1),(2,2),(2,0),(3,1)

test_cases:
  - name: "Top-1 by a DESC"
    sql: "SELECT a, b FROM ord_t ORDER BY a DESC LIMIT 1"
    expect:
      rows: 1
      data:
        - a: 3
          b: 1

  - name: "Top-1 by a ASC"
    sql: "SELECT a FROM ord_t ORDER BY a ASC LIMIT 1"
    expect:
      rows: 1
      data:
        - a: 1

  - name: "Top-2 by a DESC (no offset)"
    sql: "SELECT a FROM ord_t ORDER BY a DESC LIMIT 2"
    expect:
      rows: 2
      data:
        - a: 3

  # TODO(memcp): Multi-key ordering with LIMIT/OFFSET
  # - name: "Multi-key order with limit/offset"
  #   sql: "SELECT a, b FROM ord_t ORDER BY a DESC, b ASC LIMIT 2 OFFSET 1"
  #   expect:
  #     rows: 2
  #     data:
  #       - a: 2
  #         b: 0
  #       - a: 2
  #         b: 2

cleanup:
  - sql: "DROP TABLE IF EXISTS ord_t"
